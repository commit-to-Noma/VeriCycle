<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - VeriCycle</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="dark-theme">
    
    {% include '_navbar.html' %}

    <main class="container app-dashboard">
        <div class="dashboard-header">
            <h2>My Profile</h2>
            <p>Keep your account details up to date.</p>
        </div>

        <div class="card">
            
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="flash-message {{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <form action="{{ url_for('profile') }}" method="POST" class="verify-form">
                
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" value="{{ current_user.email }}" disabled>
                    <small class="form-note">Your email is your username and cannot be changed.</small>
                </div>

                <div class="form-group">
                    <label for="full_name">
                        Full Name
                        <span class="tooltip" data-tooltip="This must match the name on your ID for verification.">ⓘ</span>
                    </label>
                    <input type="text" id="full_name" name="full_name" value="{{ current_user.full_name or '' }}" placeholder="As it appears on your ID" required>
                </div>

                <div class="form-group">
                    <label for="id_number">
                        SA ID Number (or Passport)
                        <span class="tooltip" data-tooltip="Required for identity verification and to generate official income reports.">ⓘ</span>
                    </label>
                    <input type="text" id="id_number" name="id_number" value="{{ current_user.id_number or '' }}" placeholder="Your 13-digit ID Number" required>
                </div>

                <div class="form-group">
                    <label for="phone_number">
                        Phone Number
                        <span class="tooltip" data-tooltip="Required to contact you about your account or rewards.">ⓘ</span>
                    </label>
                    <input type="text" id="phone_number" name="phone_number" value="{{ current_user.phone_number or '' }}" placeholder="e.g., 081 123 4567" required>
                </div>

                <div class="form-group">
                    <label for="address">
                        Address (Optional)
                        <span class="tooltip" data-tooltip="Providing an address helps us identify recycling needs in your neighborhood.">ⓘ</span>
                    </label>
                    <input type="text" id="address" name="address" value="{{ current_user.address or '' }}" placeholder="e.g., 123 Main St, Roodepoort">
                </div>

            <button type="submit" class="btn-primary-large btn-form">Save and Continue</button>

        </form>
    </div> <!-- This DIV now correctly closes the Profile card -->

    <div class="card">
        <h3>My Hedera Wallet</h3>
        <p class="form-note" style="margin-top: -1rem; margin-bottom: 1.5rem; line-height: 1.5;">
            Your VeriCycle account is a real, self-custody Hedera wallet. This allows us to send you EcoCoin directly and securely.
        </p>

        <div class="form-group">
            <label>Your Hedera Account ID</label>
            <input type="text" value="{{ current_user.hedera_account_id or 'N/A (Center Account)' }}" readonly disabled>
        </div>

        <div class="form-group">
            <label>Your Private Key (Keep this secret!)</label>
            <input type="text" value="{{ current_user.hedera_private_key or 'N/A (Center Account)' }}" readonly disabled>
        </div>

        <p class="form-note">
            <strong>This is your wallet.</strong> You can import this account into a wallet like <a href="https://www.hashpack.app/" target="_blank" style="color: #2196F3;">HashPack</a> at any time using your Private Key.
        </p>
    </div>
    </main>

</body>
</html>
